{"ast":null,"code":"import React,{useEffect,useState,useRef}from'react';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Dashboard(){const[files,setFiles]=useState([]);const[filter,setFilter]=useState('all');const[currentPage,setCurrentPage]=useState(1);const filesPerPage=5;const[selectedFile,setSelectedFile]=useState(null);const prevResults=useRef({});const fetchFiles=async()=>{try{const res=await axios.get('https://cyberxplore-project.onrender.com/api/files');const newFiles=res.data.files;// Alert when scan completes\nnewFiles.forEach(file=>{if(file.status==='scanned'&&prevResults.current[file._id]!=='scanned'){alert(`Scan complete: ${file.filename} → ${file.result.toUpperCase()}`);}});const statusMap={};newFiles.forEach(file=>{statusMap[file._id]=file.status;});prevResults.current=statusMap;setFiles(newFiles);}catch(err){console.error('Error fetching files:',err);}};useEffect(()=>{fetchFiles();const interval=setInterval(fetchFiles,5000);return()=>clearInterval(interval);},[]);const filteredFiles=files.filter(file=>{if(filter==='all')return true;return file.result===filter||filter==='pending'&&file.status==='pending';});const indexOfLast=currentPage*filesPerPage;const indexOfFirst=indexOfLast-filesPerPage;const currentFiles=filteredFiles.slice(indexOfFirst,indexOfLast);return/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"File Scan Dashboard\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-bar\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"statusFilter\",children:\"Filter by status:\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"statusFilter\",onChange:e=>setFilter(e.target.value),value:filter,children:[/*#__PURE__*/_jsx(\"option\",{value:\"all\",children:\"All\"}),/*#__PURE__*/_jsx(\"option\",{value:\"clean\",children:\"Clean\"}),/*#__PURE__*/_jsx(\"option\",{value:\"infected\",children:\"Infected\"}),/*#__PURE__*/_jsx(\"option\",{value:\"pending\",children:\"Pending\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"table-container\",children:/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Filename\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Result\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Uploaded At\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Scanned At\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:currentFiles.length>0?currentFiles.map(f=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:f.filename}),/*#__PURE__*/_jsx(\"td\",{className:f.status,children:f.status}),/*#__PURE__*/_jsx(\"td\",{className:f.result,children:f.result||'-'}),/*#__PURE__*/_jsx(\"td\",{children:new Date(f.uploadedAt).toLocaleString()}),/*#__PURE__*/_jsx(\"td\",{children:f.scannedAt?new Date(f.scannedAt).toLocaleString():'-'}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelectedFile(f),children:\"View\"})})]},f._id)):/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"6\",style:{textAlign:'center'},children:\"No files found.\"})})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"pagination\",children:Array.from({length:Math.ceil(filteredFiles.length/filesPerPage)}).map((_,i)=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentPage(i+1),className:currentPage===i+1?'active':'',children:i+1},i))}),selectedFile&&/*#__PURE__*/_jsx(\"div\",{className:\"modal\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"File Details\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Filename:\"}),\" \",selectedFile.filename]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Status:\"}),\" \",selectedFile.status]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Result:\"}),\" \",selectedFile.result]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Uploaded At:\"}),\" \",new Date(selectedFile.uploadedAt).toLocaleString()]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Scanned At:\"}),\" \",selectedFile.scannedAt?new Date(selectedFile.scannedAt).toLocaleString():'-']}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelectedFile(null),children:\"Close\"})]})})]});}export default Dashboard;","map":{"version":3,"names":["React","useEffect","useState","useRef","axios","jsx","_jsx","jsxs","_jsxs","Dashboard","files","setFiles","filter","setFilter","currentPage","setCurrentPage","filesPerPage","selectedFile","setSelectedFile","prevResults","fetchFiles","res","get","newFiles","data","forEach","file","status","current","_id","alert","filename","result","toUpperCase","statusMap","err","console","error","interval","setInterval","clearInterval","filteredFiles","indexOfLast","indexOfFirst","currentFiles","slice","className","children","htmlFor","id","onChange","e","target","value","length","map","f","Date","uploadedAt","toLocaleString","scannedAt","onClick","colSpan","style","textAlign","Array","from","Math","ceil","_","i"],"sources":["C:/Users/User/cyberxplore-project/frontend/src/Dashboard.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\r\nimport axios from 'axios';\r\n\r\nfunction Dashboard() {\r\n  const [files, setFiles] = useState([]);\r\n  const [filter, setFilter] = useState('all');\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const filesPerPage = 5;\r\n  const [selectedFile, setSelectedFile] = useState(null);\r\n  const prevResults = useRef({});\r\n\r\n  const fetchFiles = async () => {\r\n    try {\r\n      const res = await axios.get('https://cyberxplore-project.onrender.com/api/files')\r\n\r\n      const newFiles = res.data.files; \r\n\r\n      // Alert when scan completes\r\n      newFiles.forEach(file => {\r\n        if (\r\n          file.status === 'scanned' &&\r\n          prevResults.current[file._id] !== 'scanned'\r\n        ) {\r\n          alert(`Scan complete: ${file.filename} → ${file.result.toUpperCase()}`);\r\n        }\r\n      });\r\n\r\n      const statusMap = {};\r\n      newFiles.forEach(file => {\r\n        statusMap[file._id] = file.status;\r\n      });\r\n      prevResults.current = statusMap;\r\n\r\n      setFiles(newFiles);\r\n    } catch (err) {\r\n      console.error('Error fetching files:', err);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchFiles();\r\n    const interval = setInterval(fetchFiles, 5000);\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  const filteredFiles = files.filter(file => {\r\n    if (filter === 'all') return true;\r\n    return file.result === filter || (filter === 'pending' && file.status === 'pending');\r\n  });\r\n\r\n  const indexOfLast = currentPage * filesPerPage;\r\n  const indexOfFirst = indexOfLast - filesPerPage;\r\n  const currentFiles = filteredFiles.slice(indexOfFirst, indexOfLast);\r\n\r\n  return (\r\n    <div className=\"dashboard\">\r\n      <h2>File Scan Dashboard</h2>\r\n\r\n      <div className=\"filter-bar\">\r\n        <label htmlFor=\"statusFilter\">Filter by status:</label>\r\n        <select\r\n          id=\"statusFilter\"\r\n          onChange={(e) => setFilter(e.target.value)}\r\n          value={filter}\r\n        >\r\n          <option value=\"all\">All</option>\r\n          <option value=\"clean\">Clean</option>\r\n          <option value=\"infected\">Infected</option>\r\n          <option value=\"pending\">Pending</option>\r\n        </select>\r\n      </div>\r\n\r\n      <div className=\"table-container\">\r\n        <table>\r\n          <thead>\r\n            <tr>\r\n              <th>Filename</th>\r\n              <th>Status</th>\r\n              <th>Result</th>\r\n              <th>Uploaded At</th>\r\n              <th>Scanned At</th>\r\n              <th>Actions</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {currentFiles.length > 0 ? (\r\n              currentFiles.map((f) => (\r\n                <tr key={f._id}>\r\n                  <td>{f.filename}</td>\r\n                  <td className={f.status}>{f.status}</td>\r\n                  <td className={f.result}>{f.result || '-'}</td>\r\n                  <td>{new Date(f.uploadedAt).toLocaleString()}</td>\r\n                  <td>{f.scannedAt ? new Date(f.scannedAt).toLocaleString() : '-'}</td>\r\n                  <td><button onClick={() => setSelectedFile(f)}>View</button></td>\r\n                </tr>\r\n              ))\r\n            ) : (\r\n              <tr><td colSpan=\"6\" style={{ textAlign: 'center' }}>No files found.</td></tr>\r\n            )}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      {/* Pagination */}\r\n      <div className=\"pagination\">\r\n        {Array.from({ length: Math.ceil(filteredFiles.length / filesPerPage) }).map((_, i) => (\r\n          <button\r\n            key={i}\r\n            onClick={() => setCurrentPage(i + 1)}\r\n            className={currentPage === i + 1 ? 'active' : ''}\r\n          >\r\n            {i + 1}\r\n          </button>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Modal */}\r\n      {selectedFile && (\r\n        <div className=\"modal\">\r\n          <div className=\"modal-content\">\r\n            <h3>File Details</h3>\r\n            <p><strong>Filename:</strong> {selectedFile.filename}</p>\r\n            <p><strong>Status:</strong> {selectedFile.status}</p>\r\n            <p><strong>Result:</strong> {selectedFile.result}</p>\r\n            <p><strong>Uploaded At:</strong> {new Date(selectedFile.uploadedAt).toLocaleString()}</p>\r\n            <p><strong>Scanned At:</strong> {selectedFile.scannedAt ? new Date(selectedFile.scannedAt).toLocaleString() : '-'}</p>\r\n            <button onClick={() => setSelectedFile(null)}>Close</button>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Dashboard;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,CAAEC,MAAM,KAAQ,OAAO,CAC1D,MAAO,CAAAC,KAAK,KAAM,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE1B,QAAS,CAAAC,SAASA,CAAA,CAAG,CACnB,KAAM,CAACC,KAAK,CAAEC,QAAQ,CAAC,CAAGT,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACU,MAAM,CAAEC,SAAS,CAAC,CAAGX,QAAQ,CAAC,KAAK,CAAC,CAC3C,KAAM,CAACY,WAAW,CAAEC,cAAc,CAAC,CAAGb,QAAQ,CAAC,CAAC,CAAC,CACjD,KAAM,CAAAc,YAAY,CAAG,CAAC,CACtB,KAAM,CAACC,YAAY,CAAEC,eAAe,CAAC,CAAGhB,QAAQ,CAAC,IAAI,CAAC,CACtD,KAAM,CAAAiB,WAAW,CAAGhB,MAAM,CAAC,CAAC,CAAC,CAAC,CAE9B,KAAM,CAAAiB,UAAU,CAAG,KAAAA,CAAA,GAAY,CAC7B,GAAI,CACF,KAAM,CAAAC,GAAG,CAAG,KAAM,CAAAjB,KAAK,CAACkB,GAAG,CAAC,oDAAoD,CAAC,CAEjF,KAAM,CAAAC,QAAQ,CAAGF,GAAG,CAACG,IAAI,CAACd,KAAK,CAE/B;AACAa,QAAQ,CAACE,OAAO,CAACC,IAAI,EAAI,CACvB,GACEA,IAAI,CAACC,MAAM,GAAK,SAAS,EACzBR,WAAW,CAACS,OAAO,CAACF,IAAI,CAACG,GAAG,CAAC,GAAK,SAAS,CAC3C,CACAC,KAAK,CAAC,kBAAkBJ,IAAI,CAACK,QAAQ,MAAML,IAAI,CAACM,MAAM,CAACC,WAAW,CAAC,CAAC,EAAE,CAAC,CACzE,CACF,CAAC,CAAC,CAEF,KAAM,CAAAC,SAAS,CAAG,CAAC,CAAC,CACpBX,QAAQ,CAACE,OAAO,CAACC,IAAI,EAAI,CACvBQ,SAAS,CAACR,IAAI,CAACG,GAAG,CAAC,CAAGH,IAAI,CAACC,MAAM,CACnC,CAAC,CAAC,CACFR,WAAW,CAACS,OAAO,CAAGM,SAAS,CAE/BvB,QAAQ,CAACY,QAAQ,CAAC,CACpB,CAAE,MAAOY,GAAG,CAAE,CACZC,OAAO,CAACC,KAAK,CAAC,uBAAuB,CAAEF,GAAG,CAAC,CAC7C,CACF,CAAC,CAEDlC,SAAS,CAAC,IAAM,CACdmB,UAAU,CAAC,CAAC,CACZ,KAAM,CAAAkB,QAAQ,CAAGC,WAAW,CAACnB,UAAU,CAAE,IAAI,CAAC,CAC9C,MAAO,IAAMoB,aAAa,CAACF,QAAQ,CAAC,CACtC,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAG,aAAa,CAAG/B,KAAK,CAACE,MAAM,CAACc,IAAI,EAAI,CACzC,GAAId,MAAM,GAAK,KAAK,CAAE,MAAO,KAAI,CACjC,MAAO,CAAAc,IAAI,CAACM,MAAM,GAAKpB,MAAM,EAAKA,MAAM,GAAK,SAAS,EAAIc,IAAI,CAACC,MAAM,GAAK,SAAU,CACtF,CAAC,CAAC,CAEF,KAAM,CAAAe,WAAW,CAAG5B,WAAW,CAAGE,YAAY,CAC9C,KAAM,CAAA2B,YAAY,CAAGD,WAAW,CAAG1B,YAAY,CAC/C,KAAM,CAAA4B,YAAY,CAAGH,aAAa,CAACI,KAAK,CAACF,YAAY,CAAED,WAAW,CAAC,CAEnE,mBACElC,KAAA,QAAKsC,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxBzC,IAAA,OAAAyC,QAAA,CAAI,qBAAmB,CAAI,CAAC,cAE5BvC,KAAA,QAAKsC,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzBzC,IAAA,UAAO0C,OAAO,CAAC,cAAc,CAAAD,QAAA,CAAC,mBAAiB,CAAO,CAAC,cACvDvC,KAAA,WACEyC,EAAE,CAAC,cAAc,CACjBC,QAAQ,CAAGC,CAAC,EAAKtC,SAAS,CAACsC,CAAC,CAACC,MAAM,CAACC,KAAK,CAAE,CAC3CA,KAAK,CAAEzC,MAAO,CAAAmC,QAAA,eAEdzC,IAAA,WAAQ+C,KAAK,CAAC,KAAK,CAAAN,QAAA,CAAC,KAAG,CAAQ,CAAC,cAChCzC,IAAA,WAAQ+C,KAAK,CAAC,OAAO,CAAAN,QAAA,CAAC,OAAK,CAAQ,CAAC,cACpCzC,IAAA,WAAQ+C,KAAK,CAAC,UAAU,CAAAN,QAAA,CAAC,UAAQ,CAAQ,CAAC,cAC1CzC,IAAA,WAAQ+C,KAAK,CAAC,SAAS,CAAAN,QAAA,CAAC,SAAO,CAAQ,CAAC,EAClC,CAAC,EACN,CAAC,cAENzC,IAAA,QAAKwC,SAAS,CAAC,iBAAiB,CAAAC,QAAA,cAC9BvC,KAAA,UAAAuC,QAAA,eACEzC,IAAA,UAAAyC,QAAA,cACEvC,KAAA,OAAAuC,QAAA,eACEzC,IAAA,OAAAyC,QAAA,CAAI,UAAQ,CAAI,CAAC,cACjBzC,IAAA,OAAAyC,QAAA,CAAI,QAAM,CAAI,CAAC,cACfzC,IAAA,OAAAyC,QAAA,CAAI,QAAM,CAAI,CAAC,cACfzC,IAAA,OAAAyC,QAAA,CAAI,aAAW,CAAI,CAAC,cACpBzC,IAAA,OAAAyC,QAAA,CAAI,YAAU,CAAI,CAAC,cACnBzC,IAAA,OAAAyC,QAAA,CAAI,SAAO,CAAI,CAAC,EACd,CAAC,CACA,CAAC,cACRzC,IAAA,UAAAyC,QAAA,CACGH,YAAY,CAACU,MAAM,CAAG,CAAC,CACtBV,YAAY,CAACW,GAAG,CAAEC,CAAC,eACjBhD,KAAA,OAAAuC,QAAA,eACEzC,IAAA,OAAAyC,QAAA,CAAKS,CAAC,CAACzB,QAAQ,CAAK,CAAC,cACrBzB,IAAA,OAAIwC,SAAS,CAAEU,CAAC,CAAC7B,MAAO,CAAAoB,QAAA,CAAES,CAAC,CAAC7B,MAAM,CAAK,CAAC,cACxCrB,IAAA,OAAIwC,SAAS,CAAEU,CAAC,CAACxB,MAAO,CAAAe,QAAA,CAAES,CAAC,CAACxB,MAAM,EAAI,GAAG,CAAK,CAAC,cAC/C1B,IAAA,OAAAyC,QAAA,CAAK,GAAI,CAAAU,IAAI,CAACD,CAAC,CAACE,UAAU,CAAC,CAACC,cAAc,CAAC,CAAC,CAAK,CAAC,cAClDrD,IAAA,OAAAyC,QAAA,CAAKS,CAAC,CAACI,SAAS,CAAG,GAAI,CAAAH,IAAI,CAACD,CAAC,CAACI,SAAS,CAAC,CAACD,cAAc,CAAC,CAAC,CAAG,GAAG,CAAK,CAAC,cACrErD,IAAA,OAAAyC,QAAA,cAAIzC,IAAA,WAAQuD,OAAO,CAAEA,CAAA,GAAM3C,eAAe,CAACsC,CAAC,CAAE,CAAAT,QAAA,CAAC,MAAI,CAAQ,CAAC,CAAI,CAAC,GAN1DS,CAAC,CAAC3B,GAOP,CACL,CAAC,cAEFvB,IAAA,OAAAyC,QAAA,cAAIzC,IAAA,OAAIwD,OAAO,CAAC,GAAG,CAACC,KAAK,CAAE,CAAEC,SAAS,CAAE,QAAS,CAAE,CAAAjB,QAAA,CAAC,iBAAe,CAAI,CAAC,CAAI,CAC7E,CACI,CAAC,EACH,CAAC,CACL,CAAC,cAGNzC,IAAA,QAAKwC,SAAS,CAAC,YAAY,CAAAC,QAAA,CACxBkB,KAAK,CAACC,IAAI,CAAC,CAAEZ,MAAM,CAAEa,IAAI,CAACC,IAAI,CAAC3B,aAAa,CAACa,MAAM,CAAGtC,YAAY,CAAE,CAAC,CAAC,CAACuC,GAAG,CAAC,CAACc,CAAC,CAAEC,CAAC,gBAC/EhE,IAAA,WAEEuD,OAAO,CAAEA,CAAA,GAAM9C,cAAc,CAACuD,CAAC,CAAG,CAAC,CAAE,CACrCxB,SAAS,CAAEhC,WAAW,GAAKwD,CAAC,CAAG,CAAC,CAAG,QAAQ,CAAG,EAAG,CAAAvB,QAAA,CAEhDuB,CAAC,CAAG,CAAC,EAJDA,CAKC,CACT,CAAC,CACC,CAAC,CAGLrD,YAAY,eACXX,IAAA,QAAKwC,SAAS,CAAC,OAAO,CAAAC,QAAA,cACpBvC,KAAA,QAAKsC,SAAS,CAAC,eAAe,CAAAC,QAAA,eAC5BzC,IAAA,OAAAyC,QAAA,CAAI,cAAY,CAAI,CAAC,cACrBvC,KAAA,MAAAuC,QAAA,eAAGzC,IAAA,WAAAyC,QAAA,CAAQ,WAAS,CAAQ,CAAC,IAAC,CAAC9B,YAAY,CAACc,QAAQ,EAAI,CAAC,cACzDvB,KAAA,MAAAuC,QAAA,eAAGzC,IAAA,WAAAyC,QAAA,CAAQ,SAAO,CAAQ,CAAC,IAAC,CAAC9B,YAAY,CAACU,MAAM,EAAI,CAAC,cACrDnB,KAAA,MAAAuC,QAAA,eAAGzC,IAAA,WAAAyC,QAAA,CAAQ,SAAO,CAAQ,CAAC,IAAC,CAAC9B,YAAY,CAACe,MAAM,EAAI,CAAC,cACrDxB,KAAA,MAAAuC,QAAA,eAAGzC,IAAA,WAAAyC,QAAA,CAAQ,cAAY,CAAQ,CAAC,IAAC,CAAC,GAAI,CAAAU,IAAI,CAACxC,YAAY,CAACyC,UAAU,CAAC,CAACC,cAAc,CAAC,CAAC,EAAI,CAAC,cACzFnD,KAAA,MAAAuC,QAAA,eAAGzC,IAAA,WAAAyC,QAAA,CAAQ,aAAW,CAAQ,CAAC,IAAC,CAAC9B,YAAY,CAAC2C,SAAS,CAAG,GAAI,CAAAH,IAAI,CAACxC,YAAY,CAAC2C,SAAS,CAAC,CAACD,cAAc,CAAC,CAAC,CAAG,GAAG,EAAI,CAAC,cACtHrD,IAAA,WAAQuD,OAAO,CAAEA,CAAA,GAAM3C,eAAe,CAAC,IAAI,CAAE,CAAA6B,QAAA,CAAC,OAAK,CAAQ,CAAC,EACzD,CAAC,CACH,CACN,EACE,CAAC,CAEV,CAEA,cAAe,CAAAtC,SAAS","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}